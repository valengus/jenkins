jenkins_java_pkg: java-21-openjdk
jenkins_repo_url: "http://pkg.jenkins.io/redhat-stable"
jenkins_version: 2.492.3-1.1

jenkins_admin_user: "admin"
jenkins_admin_user_pass: "password"

jenkins_groovy_starup_script: |
  import jenkins.model.*
  import hudson.security.*
  
  def instance = Jenkins.getInstance()
  def hudsonRealm = new HudsonPrivateSecurityRealm(false)
  
  hudsonRealm.createAccount('{{ jenkins_admin_user }}', '{{ jenkins_admin_user_pass }}')
  instance.setSecurityRealm(hudsonRealm)
  
  def strategy = new FullControlOnceLoggedInAuthorizationStrategy()
  strategy.setAllowAnonymousRead(true)
  instance.setAuthorizationStrategy(strategy)
  
  instance.save()

jenkins_plugins:
- name: git
- name: job-dsl
- name: workflow-aggregator
- name: script-security
- name: pipeline-stage-view
- name: git-parameter

jenkins_configuration_as_code:
  install: true
  local_path: /var/lib/jenkins/jenkins-config-as-code.yaml
  jenkins_cac_config:
    jenkins:
      securityRealm:
        local:
          allowsSignup: false
          users:
          - id: "{{ jenkins_admin_user }}"
            password: "{{ jenkins_admin_user_pass }}"
      authorizationStrategy: loggedInUsersCanDoAnything
    security:
      globalJobDslSecurityConfiguration:
        useScriptSecurity: false
